---
# name: General package installation

- name: Check if master is initialized
  stat:
    path: /etc/kubernetes/admin.conf
  register: master_initialized

- name: Initialize master
  command: "kubeadm init --apiserver-advertise-address {{ kube_master_ip }}  --pod-network-cidr {{ kube_pod_network }} --skip-preflight-checks"
  when: master_initialized.stat.exists == False

- name: Create token
  command: kubeadm token create
